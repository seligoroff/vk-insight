# Настройка

## Получение токена VK API

1. Перейдите на [VK Developers](https://vk.com/dev)
2. Создайте приложение
3. Получите токен доступа с необходимыми правами:
   - `wall` - для работы со стенами
   - `groups` - для работы с группами
   - `audio` - для работы с аудио (если нужно)

## Настройка переменных окружения

Создайте файл `.env` и настройте следующие параметры:

```env
VK_TOKEN=ваш_токен_vk_api
VK_API_VERSION=5.122
VK_VERIFY_SSL=false
VK_ACCOUNT_BASE_URL=https://vk.com
VK_ANALYTICS_TIMEZONE=Europe/Moscow
```

### Параметры VK API

- `VK_TOKEN` - токен доступа VK API (обязательный)
- `VK_API_VERSION` - версия API (по умолчанию: 5.122)
- `VK_VERIFY_SSL` - проверка SSL сертификатов (по умолчанию: false)
- `VK_ACCOUNT_BASE_URL` - базовый URL аккаунта для генерации ссылок (по умолчанию: https://vk.com)
- `VK_ANALYTICS_TIMEZONE` - таймзона для аналитики (по умолчанию: используется `APP_TIMEZONE` или UTC)

**Примечание:** `VK_ANALYTICS_TIMEZONE` используется командой `vk:analytics` для группировки постов по часам и дням недели. Для российских групп рекомендуется указать `Europe/Moscow`. Если не указано, используется таймзона из `APP_TIMEZONE` или UTC.

## Подготовка списка групп

Для команд, работающих со списком групп, создайте файл `resources/vk-groups.csv` со списком URL групп:

```csv
https://vk.com/groupname1
https://vk.com/groupname2
https://vk.com/anothergroup
```

Каждая строка должна содержать полный URL группы VK.

Файл можно создать автоматически:
```bash
make vk-groups-file
```

## Как узнать ID группы или пользователя

### ID группы:
1. Откройте группу в VK
2. Посмотрите на URL: `https://vk.com/club12345678` или `https://vk.com/groupname`
3. Если видите `club` или число в URL - это ID группы
4. Для использования в командах добавьте минус: `-12345678`

### ID пользователя:
1. Откройте профиль пользователя
2. В URL будет `https://vk.com/id12345678` или `https://vk.com/username`
3. Число после `id` - это ID пользователя

### Резолв короткого имени:
Можно использовать короткое имя группы (screen name) вместо ID. Инструмент автоматически резолвит его в ID.

## Структура файлов

```
resources/
└── vk-groups.csv          # Список групп (создается вручную)

database/
└── database.sqlite        # SQLite база данных (создается автоматически)
                           # Содержит таблицы: vk_posts, vk_check_cache
                           # vk_posts - хранит посты для аналитики и поиска
                           # vk_check_cache - кеш результатов команды vk:check
```


